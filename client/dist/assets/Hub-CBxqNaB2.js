import{r as d,_ as ke,g as je,a as He,j as h,e as me,T as Ie,u as Ne,b as Ye,c as Ve,i as Be,E as Ze,B as We,d as Xe,f as Ke,h as q,k as $e,l as fe,D as Qe,V as Ct,O as pe,P as ge,m as ye,n as qe,M as Ge,o as Je,Q as ts,R as es,S as ss,p as is,q as ns,s as os,t as rs,v as as,w as gt,x as ls,C as cs,y as Ee,z as hs}from"./index-B-Vb4X4W.js";const Oe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},ds=d.createContext(void 0),ve=i=>d.useContext(ds)||je(),xe=i=>typeof(i==null?void 0:i.then)=="function",us=i=>{i.status="pending",i.then(t=>{i.status="fulfilled",i.value=t},t=>{i.status="rejected",i.reason=t})},_s=ke.use||(i=>{if(i.status==="pending")throw i;if(i.status==="fulfilled")return i.value;throw i.status==="rejected"?i.reason:(us(i),i)}),At=new WeakMap,ms=i=>{let t=At.get(i);return t||(t=new Promise((e,s)=>{let n=i;const o=m=>u=>{n===m&&e(u)},c=m=>u=>{n===m&&s(u)},a=m=>{"onCancel"in m&&typeof m.onCancel=="function"&&m.onCancel(u=>{if((Oe?"production":void 0)!=="production"&&u===m)throw new Error("[Bug] p is not updated even after cancelation");xe(u)?(At.set(u,t),n=u,u.then(o(u),c(u)),a(u)):e(u)})};i.then(o(i),c(i)),a(i)}),At.set(i,t)),t};function fs(i,t){const e=ve(),[[s,n,o],c]=d.useReducer(u=>{const E=e.get(i);return Object.is(u[0],E)&&u[1]===e&&u[2]===i?u:[E,e,i]},void 0,()=>[e.get(i),e,i]);let a=s;if((n!==e||o!==i)&&(c(),a=e.get(i)),d.useEffect(()=>{const u=e.sub(i,()=>{c()});return c(),u},[e,i,void 0]),d.useDebugValue(a),xe(a)){const u=ms(a);return _s(u)}return a}function ps(i,t){const e=ve();return d.useCallback((...n)=>{if((Oe?"production":void 0)!=="production"&&!("write"in i))throw new Error("not writable atom");return e.set(i,...n)},[e,i])}function St(i,t){return[fs(i),ps(i)]}function Mt(){return Mt=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var s in e)({}).hasOwnProperty.call(e,s)&&(i[s]=e[s])}return i},Mt.apply(null,arguments)}function Vt(i,t,e){var s,n,o,c,a;t==null&&(t=100);function m(){var E=Date.now()-c;E<t&&E>=0?s=setTimeout(m,t-E):(s=null,e||(a=i.apply(o,n),o=n=null))}var u=function(){o=this,n=arguments,c=Date.now();var E=e&&!s;return s||(s=setTimeout(m,t)),E&&(a=i.apply(o,n),o=n=null),a};return u.clear=function(){s&&(clearTimeout(s),s=null)},u.flush=function(){s&&(a=i.apply(o,n),o=n=null,clearTimeout(s),s=null)},u}Vt.debounce=Vt;var gs=Vt;const Gt=He(gs);var ys=Object.defineProperty,Es=Object.defineProperties,Os=Object.getOwnPropertyDescriptors,Jt=Object.getOwnPropertySymbols,vs=Object.prototype.hasOwnProperty,xs=Object.prototype.propertyIsEnumerable,te=(i,t,e)=>t in i?ys(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,ee=(i,t)=>{for(var e in t||(t={}))vs.call(t,e)&&te(i,e,t[e]);if(Jt)for(var e of Jt(t))xs.call(t,e)&&te(i,e,t[e]);return i},Ts=(i,t)=>Es(i,Os(t)),se,ie;typeof window<"u"&&((se=window.document)!=null&&se.createElement||((ie=window.navigator)==null?void 0:ie.product)==="ReactNative")?d.useLayoutEffect:d.useEffect;function Te(i,t,e){if(!i)return;if(e(i)===!0)return i;let s=i.child;for(;s;){const n=Te(s,t,e);if(n)return n;s=s.sibling}}function Ce(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const ne=console.error;console.error=function(){const i=[...arguments].join("");if(i!=null&&i.startsWith("Warning:")&&i.includes("useContext")){console.error=ne;return}return ne.apply(this,arguments)};const Wt=Ce(d.createContext(null));class we extends d.Component{render(){return d.createElement(Wt.Provider,{value:this._reactInternals},this.props.children)}}function Cs(){const i=d.useContext(Wt);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=d.useId();return d.useMemo(()=>{for(const s of[i,i==null?void 0:i.alternate]){if(!s)continue;const n=Te(s,!1,o=>{let c=o.memoizedState;for(;c;){if(c.memoizedState===t)return!0;c=c.next}});if(n)return n}},[i,t])}function ws(){const i=Cs(),[t]=d.useState(()=>new Map);t.clear();let e=i;for(;e;){if(e.type&&typeof e.type=="object"){const n=e.type._context===void 0&&e.type.Provider===e.type?e.type:e.type._context;n&&n!==Wt&&!t.has(n)&&t.set(n,d.useContext(Ce(n)))}e=e.return}return t}function bs(){const i=ws();return d.useMemo(()=>Array.from(i.keys()).reduce((t,e)=>s=>d.createElement(t,null,d.createElement(e.Provider,Ts(ee({},s),{value:i.get(e)}))),t=>d.createElement(we,ee({},t))),[i])}function Ls({debounce:i,scroll:t,polyfill:e,offsetSize:s}={debounce:0,scroll:!1,offsetSize:!1}){const n=e||typeof window<"u"&&window.ResizeObserver,[o,c]=d.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!n)return o.width=1280,o.height=800,[()=>{},o,()=>{}];const a=d.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),m=i?typeof i=="number"?i:i.scroll:null,u=i?typeof i=="number"?i:i.resize:null,E=d.useRef(!1);d.useEffect(()=>(E.current=!0,()=>void(E.current=!1)));const[y,C,v]=d.useMemo(()=>{const l=()=>{if(!a.current.element)return;const{left:p,top:O,width:_,height:f,bottom:g,right:b,x:S,y:A}=a.current.element.getBoundingClientRect(),j={left:p,top:O,width:_,height:f,bottom:g,right:b,x:S,y:A};a.current.element instanceof HTMLElement&&s&&(j.height=a.current.element.offsetHeight,j.width=a.current.element.offsetWidth),Object.freeze(j),E.current&&!Ss(a.current.lastBounds,j)&&c(a.current.lastBounds=j)};return[l,u?Gt(l,u):l,m?Gt(l,m):l]},[c,s,m,u]);function L(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(l=>l.removeEventListener("scroll",v,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function T(){var l;a.current.element&&(a.current.resizeObserver=new n(C),(l=a.current.resizeObserver)==null||l.observe(a.current.element),t&&a.current.scrollContainers&&a.current.scrollContainers.forEach(p=>p.addEventListener("scroll",v,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{v()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const D=l=>{!l||l===a.current.element||(L(),a.current.element=l,a.current.scrollContainers=be(l),T())};return Ds(v,!!t),Ps(C),d.useEffect(()=>{L(),T()},[t,v,C]),d.useEffect(()=>L,[]),[D,o,y]}function Ps(i){d.useEffect(()=>{const t=i;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[i])}function Ds(i,t){d.useEffect(()=>{if(t){const e=i;return window.addEventListener("scroll",e,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",e,!0)}},[i,t])}function be(i){const t=[];if(!i||i===document.body)return t;const{overflow:e,overflowX:s,overflowY:n}=window.getComputedStyle(i);return[e,s,n].some(o=>o==="auto"||o==="scroll")&&t.push(i),[...t,...be(i.parentElement)]}const Us=["x","y","top","bottom","left","right","width","height"],Ss=(i,t)=>Us.every(e=>i[e]===t[e]),Ms=d.forwardRef(function({children:t,fallback:e,resize:s,style:n,gl:o,events:c=Ke,eventSource:a,eventPrefix:m,shadows:u,linear:E,flat:y,legacy:C,orthographic:v,frameloop:L,dpr:T,performance:D,raycaster:l,camera:p,scene:O,onPointerMissed:_,onCreated:f,...g},b){d.useMemo(()=>me(Ie),[]);const S=bs(),[A,j]=Ls({scroll:!0,debounce:{scroll:50,resize:0},...s}),F=d.useRef(null),ot=d.useRef(null);d.useImperativeHandle(b,()=>F.current);const rt=Ne(_),[at,k]=d.useState(!1),[lt,I]=d.useState(!1);if(at)throw at;if(lt)throw lt;const J=d.useRef(null);Ye(()=>{const B=F.current;j.width>0&&j.height>0&&B&&(J.current||(J.current=Ve(B)),J.current.configure({gl:o,events:c,shadows:u,linear:E,flat:y,legacy:C,orthographic:v,frameloop:L,dpr:T,performance:D,raycaster:l,camera:p,scene:O,size:j,onPointerMissed:(...W)=>rt.current==null?void 0:rt.current(...W),onCreated:W=>{W.events.connect==null||W.events.connect(a?Be(a)?a.current:a:ot.current),m&&W.setEvents({compute:($,H)=>{const ht=$[m+"X"],dt=$[m+"Y"];H.pointer.set(ht/H.size.width*2-1,-(dt/H.size.height)*2+1),H.raycaster.setFromCamera(H.pointer,H.camera)}}),f==null||f(W)}}),J.current.render(h.jsx(S,{children:h.jsx(Ze,{set:I,children:h.jsx(d.Suspense,{fallback:h.jsx(We,{set:k}),children:t})})})))}),d.useEffect(()=>{const B=F.current;if(B)return()=>Xe(B)},[]);const ct=a?"none":"auto";return h.jsx("div",{ref:ot,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ct,...n},...g,children:h.jsx("div",{ref:A,style:{width:"100%",height:"100%"},children:h.jsx("canvas",{ref:F,style:{display:"block"},children:e})})})}),Rs=d.forwardRef(function(t,e){return h.jsx(we,{children:h.jsx(Ms,{...t,ref:e})})}),wt=new Ct,Xt=new Ct,As=new Ct,oe=new ye;function zs(i,t,e){const s=wt.setFromMatrixPosition(i.matrixWorld);s.project(t);const n=e.width/2,o=e.height/2;return[s.x*n+n,-(s.y*o)+o]}function Fs(i,t){const e=wt.setFromMatrixPosition(i.matrixWorld),s=Xt.setFromMatrixPosition(t.matrixWorld),n=e.sub(s),o=t.getWorldDirection(As);return n.angleTo(o)>Math.PI/2}function ks(i,t,e,s){const n=wt.setFromMatrixPosition(i.matrixWorld),o=n.clone();o.project(t),oe.set(o.x,o.y),e.setFromCamera(oe,t);const c=e.intersectObjects(s,!0);if(c.length){const a=c[0].distance;return n.distanceTo(e.ray.origin)<a}return!0}function js(i,t){if(t instanceof pe)return t.zoom;if(t instanceof ge){const e=wt.setFromMatrixPosition(i.matrixWorld),s=Xt.setFromMatrixPosition(t.matrixWorld),n=t.fov*Math.PI/180,o=e.distanceTo(s);return 1/(2*Math.tan(n/2)*o)}else return 1}function Hs(i,t,e){if(t instanceof ge||t instanceof pe){const s=wt.setFromMatrixPosition(i.matrixWorld),n=Xt.setFromMatrixPosition(t.matrixWorld),o=s.distanceTo(n),c=(e[1]-e[0])/(t.far-t.near),a=e[1]-c*t.far;return Math.round(c*o+a)}}const Bt=i=>Math.abs(i)<1e-10?0:i;function Le(i,t,e=""){let s="matrix3d(";for(let n=0;n!==16;n++)s+=Bt(t[n]*i.elements[n])+(n!==15?",":")");return e+s}const Is=(i=>t=>Le(t,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Ns=(i=>(t,e)=>Le(t,i(e),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function Ys(i){return i&&typeof i=="object"&&"current"in i}const Vs=d.forwardRef(({children:i,eps:t=.001,style:e,className:s,prepend:n,center:o,fullscreen:c,portal:a,distanceFactor:m,sprite:u=!1,transform:E=!1,occlude:y,onOcclude:C,castShadow:v,receiveShadow:L,material:T,geometry:D,zIndexRange:l=[16777271,0],calculatePosition:p=zs,as:O="div",wrapperClass:_,pointerEvents:f="auto",...g},b)=>{const{gl:S,camera:A,scene:j,size:F,raycaster:ot,events:rt,viewport:at}=q(),[k]=d.useState(()=>document.createElement(O)),lt=d.useRef(),I=d.useRef(null),J=d.useRef(0),ct=d.useRef([0,0]),B=d.useRef(null),W=d.useRef(null),$=(a==null?void 0:a.current)||rt.connected||S.domElement.parentNode,H=d.useRef(null),ht=d.useRef(!1),dt=d.useMemo(()=>y&&y!=="blending"||Array.isArray(y)&&y.length&&Ys(y[0]),[y]);d.useLayoutEffect(()=>{const Y=S.domElement;y&&y==="blending"?(Y.style.zIndex=`${Math.floor(l[0]/2)}`,Y.style.position="absolute",Y.style.pointerEvents="none"):(Y.style.zIndex=null,Y.style.position=null,Y.style.pointerEvents=null)},[y]),d.useLayoutEffect(()=>{if(I.current){const Y=lt.current=$e(k);if(j.updateMatrixWorld(),E)k.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const R=p(I.current,A,F);k.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${R[0]}px,${R[1]}px,0);transform-origin:0 0;`}return $&&(n?$.prepend(k):$.appendChild(k)),()=>{$&&$.removeChild(k),Y.unmount()}}},[$,E]),d.useLayoutEffect(()=>{_&&(k.className=_)},[_]);const Kt=d.useMemo(()=>E?{position:"absolute",top:0,left:0,width:F.width,height:F.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:o?"translate3d(-50%,-50%,0)":"none",...c&&{top:-F.height/2,left:-F.width/2,width:F.width,height:F.height},...e},[e,o,c,F,E]),De=d.useMemo(()=>({position:"absolute",pointerEvents:f}),[f]);d.useLayoutEffect(()=>{if(ht.current=!1,E){var Y;(Y=lt.current)==null||Y.render(d.createElement("div",{ref:B,style:Kt},d.createElement("div",{ref:W,style:De},d.createElement("div",{ref:b,className:s,style:e,children:i}))))}else{var R;(R=lt.current)==null||R.render(d.createElement("div",{ref:b,style:Kt,className:s,children:i}))}});const ut=d.useRef(!0);fe(Y=>{if(I.current){A.updateMatrixWorld(),I.current.updateWorldMatrix(!0,!1);const R=E?ct.current:p(I.current,A,F);if(E||Math.abs(J.current-A.zoom)>t||Math.abs(ct.current[0]-R[0])>t||Math.abs(ct.current[1]-R[1])>t){const tt=Fs(I.current,A);let Q=!1;dt&&(Array.isArray(y)?Q=y.map(et=>et.current):y!=="blending"&&(Q=[j]));const yt=ut.current;if(Q){const et=ks(I.current,A,ot,Q);ut.current=et&&!tt}else ut.current=!tt;yt!==ut.current&&(C?C(!ut.current):k.style.display=ut.current?"block":"none");const bt=Math.floor(l[0]/2),Ue=y?dt?[l[0],bt]:[bt-1,0]:l;if(k.style.zIndex=`${Hs(I.current,A,Ue)}`,E){const[et,Qt]=[F.width/2,F.height/2],Rt=A.projectionMatrix.elements[5]*Qt,{isOrthographicCamera:qt,top:Se,left:Me,bottom:Re,right:Ae}=A,ze=Is(A.matrixWorldInverse),Fe=qt?`scale(${Rt})translate(${Bt(-(Ae+Me)/2)}px,${Bt((Se+Re)/2)}px)`:`translateZ(${Rt}px)`;let st=I.current.matrixWorld;u&&(st=A.matrixWorldInverse.clone().transpose().copyPosition(st).scale(I.current.scale),st.elements[3]=st.elements[7]=st.elements[11]=0,st.elements[15]=1),k.style.width=F.width+"px",k.style.height=F.height+"px",k.style.perspective=qt?"":`${Rt}px`,B.current&&W.current&&(B.current.style.transform=`${Fe}${ze}translate(${et}px,${Qt}px)`,W.current.style.transform=Ns(st,1/((m||10)/400)))}else{const et=m===void 0?1:js(I.current,A)*m;k.style.transform=`translate3d(${R[0]}px,${R[1]}px,0) scale(${et})`}ct.current=R,J.current=A.zoom}}if(!dt&&H.current&&!ht.current)if(E){if(B.current){const R=B.current.children[0];if(R!=null&&R.clientWidth&&R!=null&&R.clientHeight){const{isOrthographicCamera:tt}=A;if(tt||D)g.scale&&(Array.isArray(g.scale)?g.scale instanceof Ct?H.current.scale.copy(g.scale.clone().divideScalar(1)):H.current.scale.set(1/g.scale[0],1/g.scale[1],1/g.scale[2]):H.current.scale.setScalar(1/g.scale));else{const Q=(m||10)/400,yt=R.clientWidth*Q,bt=R.clientHeight*Q;H.current.scale.set(yt,bt,1)}ht.current=!0}}}else{const R=k.children[0];if(R!=null&&R.clientWidth&&R!=null&&R.clientHeight){const tt=1/at.factor,Q=R.clientWidth*tt,yt=R.clientHeight*tt;H.current.scale.set(Q,yt,1),ht.current=!0}H.current.lookAt(Y.camera.position)}});const $t=d.useMemo(()=>({vertexShader:E?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[E]);return d.createElement("group",Mt({},g,{ref:I}),y&&!dt&&d.createElement("mesh",{castShadow:v,receiveShadow:L,ref:H},D||d.createElement("planeGeometry",null),T||d.createElement("shaderMaterial",{side:Qe,vertexShader:$t.vertexShader,fragmentShader:$t.fragmentShader})))});/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const z={LEFT:1,RIGHT:2,MIDDLE:4},r=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),_t={NONE:0,IN:1,OUT:-1};function it(i){return i.isPerspectiveCamera}function G(i){return i.isOrthographicCamera}const mt=Math.PI*2,re=Math.PI/2,Pe=1e-5,Et=Math.PI/180;function Z(i,t,e){return Math.max(t,Math.min(e,i))}function M(i,t=Pe){return Math.abs(i)<t}function U(i,t,e=Pe){return M(i-t,e)}function ae(i,t){return Math.round(i/t)*t}function Ot(i){return isFinite(i)?i:i<0?-Number.MAX_VALUE:Number.MAX_VALUE}function vt(i){return Math.abs(i)<Number.MAX_VALUE?i:i*(1/0)}function Lt(i,t,e,s,n=1/0,o){s=Math.max(1e-4,s);const c=2/s,a=c*o,m=1/(1+a+.48*a*a+.235*a*a*a);let u=i-t;const E=t,y=n*s;u=Z(u,-y,y),t=i-u;const C=(e.value+c*u)*o;e.value=(e.value-c*C)*m;let v=t+(u+C)*m;return E-i>0==v>E&&(v=E,e.value=(v-E)/o),v}function le(i,t,e,s,n=1/0,o,c){s=Math.max(1e-4,s);const a=2/s,m=a*o,u=1/(1+m+.48*m*m+.235*m*m*m);let E=t.x,y=t.y,C=t.z,v=i.x-E,L=i.y-y,T=i.z-C;const D=E,l=y,p=C,O=n*s,_=O*O,f=v*v+L*L+T*T;if(f>_){const k=Math.sqrt(f);v=v/k*O,L=L/k*O,T=T/k*O}E=i.x-v,y=i.y-L,C=i.z-T;const g=(e.x+a*v)*o,b=(e.y+a*L)*o,S=(e.z+a*T)*o;e.x=(e.x-a*g)*u,e.y=(e.y-a*b)*u,e.z=(e.z-a*S)*u,c.x=E+(v+g)*u,c.y=y+(L+b)*u,c.z=C+(T+S)*u;const A=D-i.x,j=l-i.y,F=p-i.z,ot=c.x-D,rt=c.y-l,at=c.z-p;return A*ot+j*rt+F*at>0&&(c.x=D,c.y=l,c.z=p,e.x=(c.x-D)/o,e.y=(c.y-l)/o,e.z=(c.z-p)/o),c}function zt(i,t){t.set(0,0),i.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=i.length,t.y/=i.length}function Ft(i,t){return G(i)?(console.warn(`${t} is not supported in OrthographicCamera`),!0):!1}class Bs{constructor(){this._listeners={}}addEventListener(t,e){const s=this._listeners;s[t]===void 0&&(s[t]=[]),s[t].indexOf(e)===-1&&s[t].push(e)}hasEventListener(t,e){const s=this._listeners;return s[t]!==void 0&&s[t].indexOf(e)!==-1}removeEventListener(t,e){const n=this._listeners[t];if(n!==void 0){const o=n.indexOf(e);o!==-1&&n.splice(o,1)}}removeAllEventListeners(t){if(!t){this._listeners={};return}Array.isArray(this._listeners[t])&&(this._listeners[t].length=0)}dispatchEvent(t){const s=this._listeners[t.type];if(s!==void 0){t.target=this;const n=s.slice(0);for(let o=0,c=n.length;o<c;o++)n[o].call(this,t)}}}var kt;const Zs="2.9.0",Pt=1/8,Ws=/Mac/.test((kt=globalThis==null?void 0:globalThis.navigator)===null||kt===void 0?void 0:kt.platform);let x,ce,Dt,jt,N,w,P,ft,xt,X,K,nt,he,de,V,Tt,pt,ue,Ht,_e,It,Nt,Ut,Yt=class Zt extends Bs{static install(t){x=t.THREE,ce=Object.freeze(new x.Vector3(0,0,0)),Dt=Object.freeze(new x.Vector3(0,1,0)),jt=Object.freeze(new x.Vector3(0,0,1)),N=new x.Vector2,w=new x.Vector3,P=new x.Vector3,ft=new x.Vector3,xt=new x.Vector3,X=new x.Vector3,K=new x.Vector3,nt=new x.Vector3,he=new x.Vector3,de=new x.Vector3,V=new x.Spherical,Tt=new x.Spherical,pt=new x.Box3,ue=new x.Box3,Ht=new x.Sphere,_e=new x.Quaternion,It=new x.Quaternion,Nt=new x.Matrix4,Ut=new x.Raycaster}static get ACTION(){return r}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=r.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=_t.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new x.Vector3,this._focalOffsetVelocity=new x.Vector3,this._zoomVelocity={value:0},this._truckInternal=(l,p,O)=>{let _,f;if(it(this._camera)){const g=w.copy(this._camera.position).sub(this._target),b=this._camera.getEffectiveFOV()*Et,S=g.length()*Math.tan(b*.5);_=this.truckSpeed*l*S/this._elementRect.height,f=this.truckSpeed*p*S/this._elementRect.height}else if(G(this._camera)){const g=this._camera;_=l*(g.right-g.left)/g.zoom/this._elementRect.width,f=p*(g.top-g.bottom)/g.zoom/this._elementRect.height}else return;this.verticalDragToForward?(O?this.setFocalOffset(this._focalOffsetEnd.x+_,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(_,0,!0),this.forward(-f,!0)):O?this.setFocalOffset(this._focalOffsetEnd.x+_,this._focalOffsetEnd.y+f,this._focalOffsetEnd.z,!0):this.truck(_,f,!0)},this._rotateInternal=(l,p)=>{const O=mt*this.azimuthRotateSpeed*l/this._elementRect.height,_=mt*this.polarRotateSpeed*p/this._elementRect.height;this.rotate(O,_,!0)},this._dollyInternal=(l,p,O)=>{const _=Math.pow(.95,-l*this.dollySpeed),f=this._sphericalEnd.radius,g=this._sphericalEnd.radius*_,b=Z(g,this.minDistance,this.maxDistance),S=b-g;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(g,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(S,!0),this._dollyToNoClamp(b,!0)):this._dollyToNoClamp(b,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?g:b)-f,this._dollyControlCoord.set(p,O)),this._lastDollyDirection=Math.sign(-l)},this._zoomInternal=(l,p,O)=>{const _=Math.pow(.95,l*this.dollySpeed),f=this._zoom,g=this._zoom*_;this.zoomTo(g,!0),this.dollyToCursor&&(this._changedZoom+=g-f,this._dollyControlCoord.set(p,O))},typeof x>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=new x.Quaternion().setFromUnitVectors(this._camera.up,Dt),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=r.NONE,this._target=new x.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new x.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new x.Spherical().setFromVector3(w.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new x.Vector3,new x.Vector3,new x.Vector3,new x.Vector3],this._updateNearPlaneCorners(),this._boundary=new x.Box3(new x.Vector3(-1/0,-1/0,-1/0),new x.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new x.Vector2,this.mouseButtons={left:r.ROTATE,middle:r.DOLLY,right:r.TRUCK,wheel:it(this._camera)?r.DOLLY:G(this._camera)?r.ZOOM:r.NONE},this.touches={one:r.TOUCH_ROTATE,two:it(this._camera)?r.TOUCH_DOLLY_TRUCK:G(this._camera)?r.TOUCH_ZOOM_TRUCK:r.NONE,three:r.TOUCH_TRUCK};const s=new x.Vector2,n=new x.Vector2,o=new x.Vector2,c=l=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const _=this._domElement.getBoundingClientRect(),f=l.clientX/_.width,g=l.clientY/_.height;if(f<this._interactiveArea.left||f>this._interactiveArea.right||g<this._interactiveArea.top||g>this._interactiveArea.bottom)return}const p=l.pointerType!=="mouse"?null:(l.buttons&z.LEFT)===z.LEFT?z.LEFT:(l.buttons&z.MIDDLE)===z.MIDDLE?z.MIDDLE:(l.buttons&z.RIGHT)===z.RIGHT?z.RIGHT:null;if(p!==null){const _=this._findPointerByMouseButton(p);_&&this._disposePointer(_)}if((l.buttons&z.LEFT)===z.LEFT&&this._lockedPointer)return;const O={pointerId:l.pointerId,clientX:l.clientX,clientY:l.clientY,deltaX:0,deltaY:0,mouseButton:p};this._activePointers.push(O),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",m),this._isDragging=!0,C(l)},a=l=>{l.cancelable&&l.preventDefault();const p=l.pointerId,O=this._lockedPointer||this._findPointerById(p);if(O){if(O.clientX=l.clientX,O.clientY=l.clientY,O.deltaX=l.movementX,O.deltaY=l.movementY,this._state=0,l.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(l.buttons&z.LEFT)===z.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(l.buttons&z.MIDDLE)===z.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(l.buttons&z.RIGHT)===z.RIGHT&&(this._state=this._state|this.mouseButtons.right);v()}},m=l=>{const p=this._findPointerById(l.pointerId);if(!(p&&p===this._lockedPointer)){if(p&&this._disposePointer(p),l.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=r.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=r.NONE;L()}};let u=-1;const E=l=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===r.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const g=this._domElement.getBoundingClientRect(),b=l.clientX/g.width,S=l.clientY/g.height;if(b<this._interactiveArea.left||b>this._interactiveArea.right||S<this._interactiveArea.top||S>this._interactiveArea.bottom)return}if(l.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===r.ROTATE||this.mouseButtons.wheel===r.TRUCK){const g=performance.now();u-g<1e3&&this._getClientRect(this._elementRect),u=g}const p=Ws?-1:-3,O=l.deltaMode===1?l.deltaY/p:l.deltaY/(p*10),_=this.dollyToCursor?(l.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,f=this.dollyToCursor?(l.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case r.ROTATE:{this._rotateInternal(l.deltaX,l.deltaY),this._isUserControllingRotate=!0;break}case r.TRUCK:{this._truckInternal(l.deltaX,l.deltaY,!1),this._isUserControllingTruck=!0;break}case r.OFFSET:{this._truckInternal(l.deltaX,l.deltaY,!0),this._isUserControllingOffset=!0;break}case r.DOLLY:{this._dollyInternal(-O,_,f),this._isUserControllingDolly=!0;break}case r.ZOOM:{this._zoomInternal(-O,_,f),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},y=l=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===Zt.ACTION.NONE){const p=l instanceof PointerEvent?l.pointerId:0,O=this._findPointerById(p);O&&this._disposePointer(O),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m);return}l.preventDefault()}},C=l=>{if(!this._enabled)return;if(zt(this._activePointers,N),this._getClientRect(this._elementRect),s.copy(N),n.copy(N),this._activePointers.length>=2){const O=N.x-this._activePointers[1].clientX,_=N.y-this._activePointers[1].clientY,f=Math.sqrt(O*O+_*_);o.set(0,f);const g=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,b=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;n.set(g,b)}if(this._state=0,!l)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in l&&l.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(l.buttons&z.LEFT)===z.LEFT&&(this._state=this._state|this.mouseButtons.left),(l.buttons&z.MIDDLE)===z.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(l.buttons&z.RIGHT)===z.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&r.ROTATE)===r.ROTATE||(this._state&r.TOUCH_ROTATE)===r.TOUCH_ROTATE||(this._state&r.TOUCH_DOLLY_ROTATE)===r.TOUCH_DOLLY_ROTATE||(this._state&r.TOUCH_ZOOM_ROTATE)===r.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&r.TRUCK)===r.TRUCK||(this._state&r.TOUCH_TRUCK)===r.TOUCH_TRUCK||(this._state&r.TOUCH_DOLLY_TRUCK)===r.TOUCH_DOLLY_TRUCK||(this._state&r.TOUCH_ZOOM_TRUCK)===r.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&r.DOLLY)===r.DOLLY||(this._state&r.TOUCH_DOLLY)===r.TOUCH_DOLLY||(this._state&r.TOUCH_DOLLY_TRUCK)===r.TOUCH_DOLLY_TRUCK||(this._state&r.TOUCH_DOLLY_OFFSET)===r.TOUCH_DOLLY_OFFSET||(this._state&r.TOUCH_DOLLY_ROTATE)===r.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&r.ZOOM)===r.ZOOM||(this._state&r.TOUCH_ZOOM)===r.TOUCH_ZOOM||(this._state&r.TOUCH_ZOOM_TRUCK)===r.TOUCH_ZOOM_TRUCK||(this._state&r.TOUCH_ZOOM_OFFSET)===r.TOUCH_ZOOM_OFFSET||(this._state&r.TOUCH_ZOOM_ROTATE)===r.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&r.OFFSET)===r.OFFSET||(this._state&r.TOUCH_OFFSET)===r.TOUCH_OFFSET||(this._state&r.TOUCH_DOLLY_OFFSET)===r.TOUCH_DOLLY_OFFSET||(this._state&r.TOUCH_ZOOM_OFFSET)===r.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},v=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,zt(this._activePointers,N);const p=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,O=p?-p.deltaX:n.x-N.x,_=p?-p.deltaY:n.y-N.y;if(n.copy(N),((this._state&r.ROTATE)===r.ROTATE||(this._state&r.TOUCH_ROTATE)===r.TOUCH_ROTATE||(this._state&r.TOUCH_DOLLY_ROTATE)===r.TOUCH_DOLLY_ROTATE||(this._state&r.TOUCH_ZOOM_ROTATE)===r.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(O,_),this._isUserControllingRotate=!0),(this._state&r.DOLLY)===r.DOLLY||(this._state&r.ZOOM)===r.ZOOM){const f=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,g=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0,b=this.dollyDragInverted?-1:1;(this._state&r.DOLLY)===r.DOLLY?(this._dollyInternal(b*_*Pt,f,g),this._isUserControllingDolly=!0):(this._zoomInternal(b*_*Pt,f,g),this._isUserControllingZoom=!0)}if((this._state&r.TOUCH_DOLLY)===r.TOUCH_DOLLY||(this._state&r.TOUCH_ZOOM)===r.TOUCH_ZOOM||(this._state&r.TOUCH_DOLLY_TRUCK)===r.TOUCH_DOLLY_TRUCK||(this._state&r.TOUCH_ZOOM_TRUCK)===r.TOUCH_ZOOM_TRUCK||(this._state&r.TOUCH_DOLLY_OFFSET)===r.TOUCH_DOLLY_OFFSET||(this._state&r.TOUCH_ZOOM_OFFSET)===r.TOUCH_ZOOM_OFFSET||(this._state&r.TOUCH_DOLLY_ROTATE)===r.TOUCH_DOLLY_ROTATE||(this._state&r.TOUCH_ZOOM_ROTATE)===r.TOUCH_ZOOM_ROTATE){const f=N.x-this._activePointers[1].clientX,g=N.y-this._activePointers[1].clientY,b=Math.sqrt(f*f+g*g),S=o.y-b;o.set(0,b);const A=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,j=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&r.TOUCH_DOLLY)===r.TOUCH_DOLLY||(this._state&r.TOUCH_DOLLY_ROTATE)===r.TOUCH_DOLLY_ROTATE||(this._state&r.TOUCH_DOLLY_TRUCK)===r.TOUCH_DOLLY_TRUCK||(this._state&r.TOUCH_DOLLY_OFFSET)===r.TOUCH_DOLLY_OFFSET?(this._dollyInternal(S*Pt,A,j),this._isUserControllingDolly=!0):(this._zoomInternal(S*Pt,A,j),this._isUserControllingZoom=!0)}((this._state&r.TRUCK)===r.TRUCK||(this._state&r.TOUCH_TRUCK)===r.TOUCH_TRUCK||(this._state&r.TOUCH_DOLLY_TRUCK)===r.TOUCH_DOLLY_TRUCK||(this._state&r.TOUCH_ZOOM_TRUCK)===r.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(O,_,!1),this._isUserControllingTruck=!0),((this._state&r.OFFSET)===r.OFFSET||(this._state&r.TOUCH_OFFSET)===r.TOUCH_OFFSET||(this._state&r.TOUCH_DOLLY_OFFSET)===r.TOUCH_DOLLY_OFFSET||(this._state&r.TOUCH_ZOOM_OFFSET)===r.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(O,_,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},L=()=>{zt(this._activePointers,N),n.copy(N),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",T),this._domElement.ownerDocument.addEventListener("pointerlockerror",D),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",m),C())},this.unlockPointer=()=>{var l,p,O;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(l=this._domElement)===null||l===void 0||l.ownerDocument.exitPointerLock(),(p=this._domElement)===null||p===void 0||p.ownerDocument.removeEventListener("pointerlockchange",T),(O=this._domElement)===null||O===void 0||O.ownerDocument.removeEventListener("pointerlockerror",D),this.cancel()};const T=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},D=()=>{this.unlockPointer()};this._addAllEventListeners=l=>{this._domElement=l,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",c),this._domElement.addEventListener("pointercancel",m),this._domElement.addEventListener("wheel",E,{passive:!1}),this._domElement.addEventListener("contextmenu",y)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",c),this._domElement.removeEventListener("pointercancel",m),this._domElement.removeEventListener("wheel",E,{passive:!1}),this._domElement.removeEventListener("contextmenu",y),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this._domElement.ownerDocument.removeEventListener("pointerlockchange",T),this._domElement.ownerDocument.removeEventListener("pointerlockerror",D))},this.cancel=()=>{this._state!==r.NONE&&(this._state=r.NONE,this._activePointers.length=0,L())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}set interactiveArea(t){this._interactiveArea.width=Z(t.width,0,1),this._interactiveArea.height=Z(t.height,0,1),this._interactiveArea.x=Z(t.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Z(t.y,0,1-this._interactiveArea.height)}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,s=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,s)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,s=!1){this._isUserControllingRotate=!1;const n=Z(t,this.minAzimuthAngle,this.maxAzimuthAngle),o=Z(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=o,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,s||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const c=!s||U(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&U(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(c)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=_t.NONE,this._changedDolly=0,this._dollyToNoClamp(Z(t,this.minDistance,this.maxDistance),e)}_dollyToNoClamp(t,e=!1){const s=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const c=this._collisionTest(),a=U(c,this._spherical.radius);if(!(s>t)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(t,c)}else this._sphericalEnd.radius=t;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const o=!e||U(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(o)}dollyInFixed(t,e=!1){this._targetEnd.add(this._getCameraDirection(xt).multiplyScalar(t)),e||this._target.copy(this._targetEnd);const s=!e||U(this._target.x,this._targetEnd.x,this.restThreshold)&&U(this._target.y,this._targetEnd.y,this.restThreshold)&&U(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=Z(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const s=!e||U(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(s)}pan(t,e,s=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,s)}truck(t,e,s=!1){this._camera.updateMatrix(),X.setFromMatrixColumn(this._camera.matrix,0),K.setFromMatrixColumn(this._camera.matrix,1),X.multiplyScalar(t),K.multiplyScalar(-e);const n=w.copy(X).add(K),o=P.copy(this._targetEnd).add(n);return this.moveTo(o.x,o.y,o.z,s)}forward(t,e=!1){w.setFromMatrixColumn(this._camera.matrix,0),w.crossVectors(this._camera.up,w),w.multiplyScalar(t);const s=P.copy(this._targetEnd).add(w);return this.moveTo(s.x,s.y,s.z,e)}elevate(t,e=!1){return w.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+w.x,this._targetEnd.y+w.y,this._targetEnd.z+w.z,e)}moveTo(t,e,s,n=!1){this._isUserControllingTruck=!1;const o=w.set(t,e,s).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,o,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);const c=!n||U(this._target.x,this._targetEnd.x,this.restThreshold)&&U(this._target.y,this._targetEnd.y,this.restThreshold)&&U(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(c)}lookInDirectionOf(t,e,s,n=!1){const a=w.set(t,e,s).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(a.x,a.y,a.z,n)}fitToBox(t,e,{cover:s=!1,paddingLeft:n=0,paddingRight:o=0,paddingBottom:c=0,paddingTop:a=0}={}){const m=[],u=t.isBox3?pt.copy(t):pt.setFromObject(t);u.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const E=ae(this._sphericalEnd.theta,re),y=ae(this._sphericalEnd.phi,re);m.push(this.rotateTo(E,y,e));const C=w.setFromSpherical(this._sphericalEnd).normalize(),v=_e.setFromUnitVectors(C,jt),L=U(Math.abs(C.y),1);L&&v.multiply(It.setFromAxisAngle(Dt,E)),v.multiply(this._yAxisUpSpaceInverse);const T=ue.makeEmpty();P.copy(u.min).applyQuaternion(v),T.expandByPoint(P),P.copy(u.min).setX(u.max.x).applyQuaternion(v),T.expandByPoint(P),P.copy(u.min).setY(u.max.y).applyQuaternion(v),T.expandByPoint(P),P.copy(u.max).setZ(u.min.z).applyQuaternion(v),T.expandByPoint(P),P.copy(u.min).setZ(u.max.z).applyQuaternion(v),T.expandByPoint(P),P.copy(u.max).setY(u.min.y).applyQuaternion(v),T.expandByPoint(P),P.copy(u.max).setX(u.min.x).applyQuaternion(v),T.expandByPoint(P),P.copy(u.max).applyQuaternion(v),T.expandByPoint(P),T.min.x-=n,T.min.y-=c,T.max.x+=o,T.max.y+=a,v.setFromUnitVectors(jt,C),L&&v.premultiply(It.invert()),v.premultiply(this._yAxisUpSpace);const D=T.getSize(w),l=T.getCenter(P).applyQuaternion(v);if(it(this._camera)){const p=this.getDistanceToFitBox(D.x,D.y,D.z,s);m.push(this.moveTo(l.x,l.y,l.z,e)),m.push(this.dollyTo(p,e)),m.push(this.setFocalOffset(0,0,0,e))}else if(G(this._camera)){const p=this._camera,O=p.right-p.left,_=p.top-p.bottom,f=s?Math.max(O/D.x,_/D.y):Math.min(O/D.x,_/D.y);m.push(this.moveTo(l.x,l.y,l.z,e)),m.push(this.zoomTo(f,e)),m.push(this.setFocalOffset(0,0,0,e))}return Promise.all(m)}fitToSphere(t,e){const s=[],o="isObject3D"in t?Zt.createBoundingSphere(t,Ht):Ht.copy(t);if(s.push(this.moveTo(o.center.x,o.center.y,o.center.z,e)),it(this._camera)){const c=this.getDistanceToFitSphere(o.radius);s.push(this.dollyTo(c,e))}else if(G(this._camera)){const c=this._camera.right-this._camera.left,a=this._camera.top-this._camera.bottom,m=2*o.radius,u=Math.min(c/m,a/m);s.push(this.zoomTo(u,e))}return s.push(this.setFocalOffset(0,0,0,e)),Promise.all(s)}setLookAt(t,e,s,n,o,c,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=_t.NONE,this._changedDolly=0;const m=P.set(n,o,c),u=w.set(t,e,s);this._targetEnd.copy(m),this._sphericalEnd.setFromVector3(u.sub(m).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const E=!a||U(this._target.x,this._targetEnd.x,this.restThreshold)&&U(this._target.y,this._targetEnd.y,this.restThreshold)&&U(this._target.z,this._targetEnd.z,this.restThreshold)&&U(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&U(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&U(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(E)}lerpLookAt(t,e,s,n,o,c,a,m,u,E,y,C,v,L=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=_t.NONE,this._changedDolly=0;const T=w.set(n,o,c),D=P.set(t,e,s);V.setFromVector3(D.sub(T).applyQuaternion(this._yAxisUpSpace));const l=ft.set(E,y,C),p=P.set(a,m,u);Tt.setFromVector3(p.sub(l).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(T.lerp(l,v));const O=Tt.theta-V.theta,_=Tt.phi-V.phi,f=Tt.radius-V.radius;this._sphericalEnd.set(V.radius+f*v,V.phi+_*v,V.theta+O*v),this.normalizeRotations(),this._needsUpdate=!0,L||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const g=!L||U(this._target.x,this._targetEnd.x,this.restThreshold)&&U(this._target.y,this._targetEnd.y,this.restThreshold)&&U(this._target.z,this._targetEnd.z,this.restThreshold)&&U(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&U(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&U(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(g)}setPosition(t,e,s,n=!1){return this.setLookAt(t,e,s,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(t,e,s,n=!1){const o=this.getPosition(w),c=this.setLookAt(o.x,o.y,o.z,t,e,s,n);return this._sphericalEnd.phi=Z(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),c}setFocalOffset(t,e,s,n=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,s),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);const o=!n||U(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&U(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&U(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}setOrbitPoint(t,e,s){this._camera.updateMatrixWorld(),X.setFromMatrixColumn(this._camera.matrixWorldInverse,0),K.setFromMatrixColumn(this._camera.matrixWorldInverse,1),nt.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const n=w.set(t,e,s),o=n.distanceTo(this._camera.position),c=n.sub(this._camera.position);X.multiplyScalar(c.x),K.multiplyScalar(c.y),nt.multiplyScalar(c.z),w.copy(X).add(K).add(nt),w.z=w.z+o,this.dollyTo(o,!1),this.setFocalOffset(-w.x,w.y,-w.z,!1),this.moveTo(t,e,s,!1)}setBoundary(t){if(!t){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,s,n){if(t===null){this._viewport=null;return}this._viewport=this._viewport||new x.Vector4,typeof t=="number"?this._viewport.set(t,e,s,n):this._viewport.copy(t)}getDistanceToFitBox(t,e,s,n=!1){if(Ft(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const o=t/e,c=this._camera.getEffectiveFOV()*Et,a=this._camera.aspect;return((n?o>a:o<a)?e:t/a)*.5/Math.tan(c*.5)+s*.5}getDistanceToFitSphere(t){if(Ft(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*Et,s=Math.atan(Math.tan(e*.5)*this._camera.aspect)*2,n=1<this._camera.aspect?e:s;return t/Math.sin(n*.5)}getTarget(t,e=!0){return(t&&t.isVector3?t:new x.Vector3).copy(e?this._targetEnd:this._target)}getPosition(t,e=!0){return(t&&t.isVector3?t:new x.Vector3).setFromSpherical(e?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(e?this._targetEnd:this._target)}getSpherical(t,e=!0){return(t||new x.Spherical).copy(e?this._sphericalEnd:this._spherical)}getFocalOffset(t,e=!0){return(t&&t.isVector3?t:new x.Vector3).copy(e?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%mt,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=mt),this._spherical.theta+=mt*Math.round((this._sphericalEnd.theta-this._spherical.theta)/mt)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(t=!1){if(!U(this._camera.up.x,this._cameraUp0.x)||!U(this._camera.up.y,this._cameraUp0.y)||!U(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const s=this.getPosition(w);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Dt),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const t=w.subVectors(this._target,this._camera.position).normalize(),e=P.crossVectors(t,this._camera.up);this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();const s=this.getPosition(w);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}update(t){const e=this._sphericalEnd.theta-this._spherical.theta,s=this._sphericalEnd.phi-this._spherical.phi,n=this._sphericalEnd.radius-this._spherical.radius,o=he.subVectors(this._targetEnd,this._target),c=de.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(M(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const y=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Lt(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,y,1/0,t),this._needsUpdate=!0}if(M(s))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const y=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Lt(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,y,1/0,t),this._needsUpdate=!0}if(M(n))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const y=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Lt(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,y,this.maxSpeed,t),this._needsUpdate=!0}if(M(o.x)&&M(o.y)&&M(o.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const y=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;le(this._target,this._targetEnd,this._targetVelocity,y,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(M(c.x)&&M(c.y)&&M(c.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const y=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;le(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,y,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(M(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const y=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Lt(this._zoom,this._zoomEnd,this._zoomVelocity,y,1/0,t)}if(this.dollyToCursor){if(it(this._camera)&&this._changedDolly!==0){const y=this._spherical.radius-this._lastDistance,C=this._camera,v=this._getCameraDirection(xt),L=w.copy(v).cross(C.up).normalize();L.lengthSq()===0&&(L.x=1);const T=P.crossVectors(L,v),D=this._sphericalEnd.radius*Math.tan(C.getEffectiveFOV()*Et*.5),p=(this._sphericalEnd.radius-y-this._sphericalEnd.radius)/this._sphericalEnd.radius,O=ft.copy(this._targetEnd).add(L.multiplyScalar(this._dollyControlCoord.x*D*C.aspect)).add(T.multiplyScalar(this._dollyControlCoord.y*D)),_=w.copy(this._targetEnd).lerp(O,p),f=this._lastDollyDirection===_t.IN&&this._spherical.radius<=this.minDistance,g=this._lastDollyDirection===_t.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(f||g)){this._sphericalEnd.radius-=y,this._spherical.radius-=y;const S=P.copy(v).multiplyScalar(-y);_.add(S)}this._boundary.clampPoint(_,_);const b=P.subVectors(_,this._targetEnd);this._targetEnd.copy(_),this._target.add(b),this._changedDolly-=y,M(this._changedDolly)&&(this._changedDolly=0)}else if(G(this._camera)&&this._changedZoom!==0){const y=this._zoom-this._lastZoom,C=this._camera,v=w.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(C.near+C.far)/(C.near-C.far)).unproject(C),L=P.set(0,0,-1).applyQuaternion(C.quaternion),T=ft.copy(v).add(L.multiplyScalar(-v.dot(C.up))),l=-(this._zoom-y-this._zoom)/this._zoom,p=this._getCameraDirection(xt),O=this._targetEnd.dot(p),_=w.copy(this._targetEnd).lerp(T,l),f=_.dot(p),g=p.multiplyScalar(f-O);_.sub(g),this._boundary.clampPoint(_,_);const b=P.subVectors(_,this._targetEnd);this._targetEnd.copy(_),this._target.add(b),this._changedZoom-=y,M(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const m=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,m),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!M(this._focalOffset.x)||!M(this._focalOffset.y)||!M(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),X.setFromMatrixColumn(this._camera.matrix,0),K.setFromMatrixColumn(this._camera.matrix,1),nt.setFromMatrixColumn(this._camera.matrix,2),X.multiplyScalar(this._focalOffset.x),K.multiplyScalar(-this._focalOffset.y),nt.multiplyScalar(this._focalOffset.z),w.copy(X).add(K).add(nt),this._camera.position.add(w)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),w.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const E=this._needsUpdate;return E&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):E?(this.dispatchEvent({type:"update"}),M(e,this.restThreshold)&&M(s,this.restThreshold)&&M(n,this.restThreshold)&&M(o.x,this.restThreshold)&&M(o.y,this.restThreshold)&&M(o.z,this.restThreshold)&&M(c.x,this.restThreshold)&&M(c.y,this.restThreshold)&&M(c.z,this.restThreshold)&&M(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!E&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=E,this._needsUpdate=!1,E}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Ot(this.maxDistance),minZoom:this.minZoom,maxZoom:Ot(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Ot(this.maxPolarAngle),minAzimuthAngle:Ot(this.minAzimuthAngle),maxAzimuthAngle:Ot(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:w.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const s=JSON.parse(t);this.enabled=s.enabled,this.minDistance=s.minDistance,this.maxDistance=vt(s.maxDistance),this.minZoom=s.minZoom,this.maxZoom=vt(s.maxZoom),this.minPolarAngle=s.minPolarAngle,this.maxPolarAngle=vt(s.maxPolarAngle),this.minAzimuthAngle=vt(s.minAzimuthAngle),this.maxAzimuthAngle=vt(s.maxAzimuthAngle),this.smoothTime=s.smoothTime,this.draggingSmoothTime=s.draggingSmoothTime,this.dollySpeed=s.dollySpeed,this.truckSpeed=s.truckSpeed,this.dollyToCursor=s.dollyToCursor,this.verticalDragToForward=s.verticalDragToForward,this._target0.fromArray(s.target0),this._position0.fromArray(s.position0),this._zoom0=s.zoom0,this._focalOffset0.fromArray(s.focalOffset0),this.moveTo(s.target[0],s.target[1],s.target[2],e),V.setFromVector3(w.fromArray(s.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(V.theta,V.phi,e),this.dollyTo(V.radius,e),this.zoomTo(s.zoom,e),this.setFocalOffset(s.focalOffset[0],s.focalOffset[1],s.focalOffset[2],e),this._needsUpdate=!0}connect(t){if(this._domElement){console.warn("camera-controls is already connected.");return}t.setAttribute("data-camera-controls-version",Zs),this._addAllEventListeners(t),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(t){return t.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(t){return this._getTargetDirection(t).negate()}_findPointerById(t){return this._activePointers.find(e=>e.pointerId===t)}_findPointerByMouseButton(t){return this._activePointers.find(e=>e.mouseButton===t)}_disposePointer(t){this._activePointers.splice(this._activePointers.indexOf(t),1)}_encloseToBoundary(t,e,s){const n=e.lengthSq();if(n===0)return t;const o=P.copy(e).add(t),a=this._boundary.clampPoint(o,ft).sub(o),m=a.lengthSq();if(m===0)return t.add(e);if(m===n)return t;if(s===0)return t.add(e).add(a);{const u=1+s*m/e.dot(a);return t.add(P.copy(e).multiplyScalar(u)).add(a.multiplyScalar(1-s))}}_updateNearPlaneCorners(){if(it(this._camera)){const t=this._camera,e=t.near,s=t.getEffectiveFOV()*Et,n=Math.tan(s*.5)*e,o=n*t.aspect;this._nearPlaneCorners[0].set(-o,-n,0),this._nearPlaneCorners[1].set(o,-n,0),this._nearPlaneCorners[2].set(o,n,0),this._nearPlaneCorners[3].set(-o,n,0)}else if(G(this._camera)){const t=this._camera,e=1/t.zoom,s=t.left*e,n=t.right*e,o=t.top*e,c=t.bottom*e;this._nearPlaneCorners[0].set(s,o,0),this._nearPlaneCorners[1].set(n,o,0),this._nearPlaneCorners[2].set(n,c,0),this._nearPlaneCorners[3].set(s,c,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1)||Ft(this._camera,"_collisionTest"))return t;const s=this._getTargetDirection(xt);Nt.lookAt(ce,s,this._camera.up);for(let n=0;n<4;n++){const o=P.copy(this._nearPlaneCorners[n]);o.applyMatrix4(Nt);const c=ft.addVectors(this._target,o);Ut.set(c,s),Ut.far=this._spherical.radius+1;const a=Ut.intersectObjects(this.colliderMeshes);a.length!==0&&a[0].distance<t&&(t=a[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{const s=()=>{this.removeEventListener("rest",s),e()};this.addEventListener("rest",s)}))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new x.Sphere){const s=e,n=s.center;pt.makeEmpty(),t.traverseVisible(c=>{c.isMesh&&pt.expandByObject(c)}),pt.getCenter(n);let o=0;return t.traverseVisible(c=>{if(!c.isMesh)return;const a=c,m=a.geometry.clone();m.applyMatrix4(a.matrixWorld);const E=m.attributes.position;for(let y=0,C=E.count;y<C;y++)w.fromBufferAttribute(E,y),o=Math.max(o,n.distanceToSquared(w))}),s.radius=Math.sqrt(o),s}};const Xs=d.forwardRef((i,t)=>{d.useMemo(()=>{const f={Box3:qe,MathUtils:{clamp:Ge.clamp},Matrix4:Je,Quaternion:ts,Raycaster:es,Sphere:ss,Spherical:is,Vector2:ye,Vector3:Ct,Vector4:ns};Yt.install({THREE:f}),me({CameraControlsImpl:Yt})},[]);const{camera:e,domElement:s,makeDefault:n,onStart:o,onEnd:c,onChange:a,regress:m,...u}=i,E=q(f=>f.camera),y=q(f=>f.gl),C=q(f=>f.invalidate),v=q(f=>f.events),L=q(f=>f.setEvents),T=q(f=>f.set),D=q(f=>f.get),l=q(f=>f.performance),p=e||E,O=s||v.connected||y.domElement,_=d.useMemo(()=>new Yt(p),[p]);return fe((f,g)=>{_.enabled&&_.update(g)},-1),d.useEffect(()=>(_.connect(O),()=>void _.disconnect()),[O,_]),d.useEffect(()=>{const f=S=>{C(),m&&l.regress(),a&&a(S)},g=S=>{o&&o(S)},b=S=>{c&&c(S)};return _.addEventListener("update",f),_.addEventListener("controlstart",g),_.addEventListener("controlend",b),_.addEventListener("control",f),_.addEventListener("transitionstart",f),_.addEventListener("wake",f),()=>{_.removeEventListener("update",f),_.removeEventListener("controlstart",g),_.removeEventListener("controlend",b),_.removeEventListener("control",f),_.removeEventListener("transitionstart",f),_.removeEventListener("wake",f)}},[_,o,c,C,L,m,a]),d.useEffect(()=>{if(n){const f=D().controls;return T({controls:_}),()=>T({controls:f})}},[n,_]),d.createElement("primitive",Mt({ref:t,object:_},u))});function Ks(){const i=d.useRef(),[t,e]=St(rs),[s,n]=St(as),[o,c]=d.useState(!1);return os(o),h.jsxs(h.Fragment,{children:[h.jsx("ambientLight",{intensity:.3}),h.jsx("directionalLight",{castShadow:!0,intensity:3,position:[1.86,5.85,6.65]}),h.jsx("directionalLight",{castShadow:!0,intensity:1,position:[-5.12,10.23,-4.43]}),t&&h.jsx("pointLight",{position:[-1.54,1.18,-.5],color:"pink",intensity:1}),s&&h.jsx("pointLight",{position:[1,1.55,1],color:"#FF5C00",intensity:2}),h.jsx("pointLight",{position:[1.2,2.35,-1.9],color:"pink",intensity:.5}),h.jsx("pointLight",{ref:i,position:[-1.3,1.18,.8],intensity:.9,color:"#1F51FF"}),h.jsx("mesh",{visible:!1,position:[.85,1.25,1.2],onClick:()=>n(!s),onPointerOver:()=>c(!0),onPointerOut:()=>c(!1),children:h.jsx("boxGeometry",{args:[.6,.67,.5]})}),h.jsx("mesh",{visible:!1,position:[-1.54,1.06,-.08],onClick:()=>e(!t),onPointerOver:()=>c(!0),onPointerOut:()=>c(!1),children:h.jsx("boxGeometry",{args:[.5,.5,.35]})})]})}function $s(){const[i,t]=St(Ee),e=d.useRef();return d.useEffect(()=>{switch(i){case 0:e.current.setLookAt(...gt.start,!0);break;case 1:e.current.setLookAt(...gt.skill,!0);break;case 2:e.current.setLookAt(...gt.book,!0);break;case 3:e.current.setLookAt(...gt.os,!0);break;case 4:e.current.setLookAt(...gt.cell,!0);break}},[i]),h.jsxs(h.Fragment,{children:[h.jsx(Xs,{ref:e,smoothTime:2,mouseButtons:{left:0,right:0,middle:0,wheel:0},touches:{one:0,two:0,three:0}}),h.jsx(Ks,{}),h.jsx(ls,{}),h.jsx(cs,{position:[0,.25,.1]})]})}function Gs(){const i=d.useRef(new Audio("/music/ambient1.mp3")),t=d.useRef(),[e,s]=d.useState(!1),[n,o]=d.useState(!1),[c,a]=St(Ee);d.useEffect(()=>{if(n)return i.current.play(),()=>i.current.pause()},[n]);const m={open:{clipPath:"circle(2500px at 40px 40px)",transition:{type:"spring",stiffness:20,mass:75}},closed:{clipPath:"circle(30px at 40px 40px)",transition:{type:"spring",stiffness:400,damping:40}}};return h.jsxs("div",{className:"relative h-screen w-full bg-black",children:[h.jsx(Rs,{shadows:!0,camera:{position:[0,3,5],fov:35},children:h.jsx(d.Suspense,{fallback:h.jsx(Qs,{}),children:h.jsx($s,{})})}),h.jsxs("div",{className:"absolute left-1/2 top-1/2 z-50 hidden w-2/3 -translate-x-1/2 -translate-y-1/2 rounded-2xl bg-[#60a6fb] p-4 text-white portrait:block pointer-events-none",children:[h.jsx("h2",{className:"text-center text-4xl",children:"Warning"}),h.jsx("p",{className:"p-4 text-center text-2xl",children:"Please view in landscape mode"})]}),h.jsx("button",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 cursor-pointer rounded-2xl border-black bg-white bg-opacity-90 px-4 py-2 text-center hover:bg-slate-300",onClick:()=>{a(u=>u===Object.keys(gt).length-1?0:u+1)},children:"Next"}),h.jsxs(hs.nav,{className:"absolute bottom-0 left-0 top-0 flex w-80 flex-col items-center border-r border-black/50 bg-white bg-opacity-90",initial:"closed",variants:m,animate:e?"open":"closed",children:[h.jsx("img",{className:"absolute left-[30px] top-[30px] scale-150 cursor-pointer select-none",src:"/images/menu.svg",alt:"",onClick:()=>s(!e)}),h.jsxs("div",{className:"absolute top-[20%] flex flex-col items-center justify-center rounded-2xl p-4 pb-2 hover:bg-slate-300/50",onClick:()=>o(!n),children:[h.jsx("div",{className:` ${n?"bg-pause":"bg-volume"} cursor-pointer rounded-lg border border-slate-600 bg-cover bg-center p-8`}),h.jsx("div",{children:n?"Stop":"Ambient"})]}),h.jsxs("div",{className:"absolute top-[50%] flex flex-col items-center justify-center rounded-2xl p-4 pb-2 hover:bg-slate-300/50",onClick:()=>t.current.showModal(),children:[h.jsx("div",{className:"cursor-pointer rounded-lg border border-slate-600 bg-share bg-cover bg-center p-8"}),h.jsx("div",{children:"Share"})]})]}),h.jsxs("dialog",{ref:t,className:"modal",children:[h.jsxs("div",{className:"modal-box",children:[h.jsx("h3",{className:"mb-4 text-center text-lg font-bold",children:"Share on Social Media"}),h.jsxs("div",{className:"flex justify-evenly",children:[h.jsxs("div",{className:"flex cursor-pointer flex-col items-center justify-center",onClick:()=>window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${window.location.origin}`,"_blank"),children:[h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12",viewBox:"0 0 512 512",fill:"#ffffff",children:[h.jsx("rect",{width:"512",height:"512",rx:"15%",fill:"#0077b5"}),h.jsx("circle",{cx:"142",cy:"138",r:"37"}),h.jsx("path",{stroke:"#ffffff",strokeWidth:"66",d:"M244 194v198M142 194v198"}),h.jsx("path",{d:"M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"})]}),h.jsx("div",{children:"LinkedIn"})]}),h.jsxs("div",{className:"flex cursor-pointer flex-col items-center justify-center",onClick:()=>window.open(`https://www.facebook.com/sharer/sharer.php?u=${window.location.origin}`,"_blank"),children:[h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"h-12 w-12",children:[h.jsx("path",{fill:"#039be5",d:"M24 5A19 19 0 1 0 24 43A19 19 0 1 0 24 5Z"}),h.jsx("path",{fill:"#fff",d:"M26.572,29.036h4.917l0.772-4.995h-5.69v-2.73c0-2.075,0.678-3.915,2.619-3.915h3.119v-4.359c-0.548-0.074-1.707-0.236-3.897-0.236c-4.573,0-7.254,2.415-7.254,7.917v3.323h-4.701v4.995h4.701v13.729C22.089,42.905,23.032,43,24,43c0.875,0,1.729-0.08,2.572-0.194V29.036z"})]}),h.jsx("div",{children:"Facebook"})]}),h.jsxs("div",{className:"flex cursor-pointer flex-col items-center justify-center",onClick:()=>window.open(`https://twitter.com/intent/tweet?url=${window.location.origin}`,"_blank"),children:[h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"h-12 w-12",children:[h.jsx("path",{fill:"#212121",fillRule:"evenodd",d:"M38,42H10c-2.209,0-4-1.791-4-4V10c0-2.209,1.791-4,4-4h28	c2.209,0,4,1.791,4,4v28C42,40.209,40.209,42,38,42z",clipRule:"evenodd"}),h.jsx("path",{fill:"#fff",d:"M34.257,34h-6.437L13.829,14h6.437L34.257,34z M28.587,32.304h2.563L19.499,15.696h-2.563 L28.587,32.304z"}),h.jsx("polygon",{fill:"#fff",points:"15.866,34 23.069,25.656 22.127,24.407 13.823,34"}),h.jsx("polygon",{fill:"#fff",points:"24.45,21.721 25.355,23.01 33.136,14 31.136,14"})]}),h.jsx("div",{children:"Twitter/X"})]}),h.jsxs("div",{className:"flex cursor-pointer flex-col items-center justify-center",onClick:()=>window.open(`https://www.addtoany.com/add_to/whatsapp?linkurl=${window.location.origin}`,"_blank"),children:[h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",className:"h-12 w-12",children:[h.jsx("path",{fill:"#fff",d:"M4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98c-0.001,0,0,0,0,0h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303z"}),h.jsx("path",{fill:"#fff",d:"M4.868,43.803c-0.132,0-0.26-0.052-0.355-0.148c-0.125-0.127-0.174-0.312-0.127-0.483l2.639-9.636c-1.636-2.906-2.499-6.206-2.497-9.556C4.532,13.238,13.273,4.5,24.014,4.5c5.21,0.002,10.105,2.031,13.784,5.713c3.679,3.683,5.704,8.577,5.702,13.781c-0.004,10.741-8.746,19.48-19.486,19.48c-3.189-0.001-6.344-0.788-9.144-2.277l-9.875,2.589C4.953,43.798,4.911,43.803,4.868,43.803z"}),h.jsx("path",{fill:"#cfd8dc",d:"M24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98h-0.008c-3.177-0.001-6.3-0.798-9.073-2.311L4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974C24.014,42.974,24.014,42.974,24.014,42.974 M24.014,4C24.014,4,24.014,4,24.014,4C12.998,4,4.032,12.962,4.027,23.979c-0.001,3.367,0.849,6.685,2.461,9.622l-2.585,9.439c-0.094,0.345,0.002,0.713,0.254,0.967c0.19,0.192,0.447,0.297,0.711,0.297c0.085,0,0.17-0.011,0.254-0.033l9.687-2.54c2.828,1.468,5.998,2.243,9.197,2.244c11.024,0,19.99-8.963,19.995-19.98c0.002-5.339-2.075-10.359-5.848-14.135C34.378,6.083,29.357,4.002,24.014,4L24.014,4z"}),h.jsx("path",{fill:"#40c351",d:"M35.176,12.832c-2.98-2.982-6.941-4.625-11.157-4.626c-8.704,0-15.783,7.076-15.787,15.774c-0.001,2.981,0.833,5.883,2.413,8.396l0.376,0.597l-1.595,5.821l5.973-1.566l0.577,0.342c2.422,1.438,5.2,2.198,8.032,2.199h0.006c8.698,0,15.777-7.077,15.78-15.776C39.795,19.778,38.156,15.814,35.176,12.832z"}),h.jsx("path",{fill:"#fff",fillRule:"evenodd",d:"M19.268,16.045c-0.355-0.79-0.729-0.806-1.068-0.82c-0.277-0.012-0.593-0.011-0.909-0.011c-0.316,0-0.83,0.119-1.265,0.594c-0.435,0.475-1.661,1.622-1.661,3.956c0,2.334,1.7,4.59,1.937,4.906c0.237,0.316,3.282,5.259,8.104,7.161c4.007,1.58,4.823,1.266,5.693,1.187c0.87-0.079,2.807-1.147,3.202-2.255c0.395-1.108,0.395-2.057,0.277-2.255c-0.119-0.198-0.435-0.316-0.909-0.554s-2.807-1.385-3.242-1.543c-0.435-0.158-0.751-0.237-1.068,0.238c-0.316,0.474-1.225,1.543-1.502,1.859c-0.277,0.317-0.554,0.357-1.028,0.119c-0.474-0.238-2.002-0.738-3.815-2.354c-1.41-1.257-2.362-2.81-2.639-3.285c-0.277-0.474-0.03-0.731,0.208-0.968c0.213-0.213,0.474-0.554,0.712-0.831c0.237-0.277,0.316-0.475,0.474-0.791c0.158-0.317,0.079-0.594-0.04-0.831C20.612,19.329,19.69,16.983,19.268,16.045z",clipRule:"evenodd"})]}),h.jsx("div",{children:"WhatsApp"})]}),h.jsxs("div",{className:"flex flex-col items-center justify-center",onClick:()=>window.open(`mailto:?&subject=Developer%20Profile&cc=&bcc=&body=${window.location.origin}`,"_blank"),children:[h.jsx("svg",{className:"h-12 w-12 fill-slate-500/80",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})}),h.jsx("div",{children:"Email"})]})]})]}),h.jsx("form",{method:"dialog",className:"modal-backdrop",children:h.jsx("button",{children:"close"})})]})]})}function Qs(){return h.jsx(Vs,{as:"div",className:"relative flex h-screen w-full items-center justify-center bg-peacocktw bg-cover bg-center",center:!0,children:h.jsx("h1",{className:"text-center font-waterBrush tracking-widest text-8xl text-red-500",children:"Loading"})})}export{Gs as default};
